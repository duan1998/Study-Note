# 程序的机器级表示

### 描述

计算机执行机器代码，用字节序列编码低级的操作，包括**处理数据**，**管理内存**，**读写存储设备上的数据**，以及利用**网络通信**。

### 过程

编译器基于编程语言的规则，目标机器的**指令集**和操作系统遵循的惯例，最后生成机器代码

例如GCC，GCC语言编译器以汇编代码的形式输出，汇编代码是机器代码的**文本表示**，然后GCC驱动程序调用汇编器和链接器，根据汇编代码生成可执行的机器代码

### 为啥子汇编语言以及机器语言直接用的少

高级语言的**抽象程序较高**，更有效率，优化做的好的编译器是可以将效率和汇编相提并论的，且有检错功能

另外一个点就是汇编是与**机器硬件的指令集**相关的，而高级语言可以**跨平台移植**

### 机器语言

**IA32**(Intel Architecture 32-bit->Inter 32位体系结构)以及最新的Intel64，即IA32的64位扩展，也称**x86-64**，**此前的系列统称为x86**

### 程序编码

##### 处理过程（C语言）

1. gcc驱动程序驱动**C预处理器**`cpp`扩展源代码**，插入所有用**#include命令指定的文件**，并扩展所有**用#define声明指定的宏**

```C
#define dprint（expr） printf（#expr “ = %/n”，expr）
//使用语句 dprint（x/y）;
//调用宏时，该宏将被扩展为：printf（“x/y”“ = %/n”，x/y）;
```

2. gcc驱动程序驱动**C编译器**`ccl`输出汇编代码
3. gcc驱动程序驱动**汇编器**`as`将**可读的文本表示**的汇编代码转换成**二进制目标代码文件**`.o`，但是此时的目标文件存在所有指令的二进制表示，却没有全局值的地址
4. gcc驱动链接器`ld`把所有目标模块链接起来，并重定位地址，最后输出可执行代码文件

##### **机器级代码**

两种对于机器级编程很重要的**系统抽象**

1. 由指令集体结构或指令集架构(Instruction Set Architecture,ISA) 来定义机器级程序的格式和行为，它定义了处理器状态，指令的格式，以及每条指令对状态的影响。（人话就是：我代码怎么影响系统状态，用啥样的指令去干什么，这点底部要给我封装好）
2. 机器级程序使用的内存是虚拟内存，提供的内存模型看上去是一个非常大的字节数组。（人话就是：弱化了机器硬件存储器的存在，因为较多和复杂）

##### **处理器的状态**

程序计数器

整数寄存器

条件码寄存器

一组向量寄存器